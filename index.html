<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text Translation Tool</title>
    <style>
        #text-box {
            width: 100%;
            height: 200px;
        }
        #output {
            white-space: pre-wrap;
            margin-top: 20px;
            border: 1px solid #ccc;
            padding: 10px;
            position: relative;
        }
        .tooltip {
            position: absolute;
            background-color: black;
            color: white;
            padding: 5px;
            border-radius: 5px;
            display: none;
            pointer-events: none;
            max-width: 200px;
            font-size: 14px;
        }
        .tooltip-description {
            font-size: 12px;
            color: #ddd;
            margin-top: 5px;
        }
        .highlight {
            background-color: yellow;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>Text Translation Tool</h1>
    <textarea id="text-box" placeholder="Paste your text here..."></textarea>
    <div id="output"></div>
    <div class="tooltip" id="tooltip"></div>

    <script>
        const translations = {}; // Placeholder for translations

        // Fetch translations from the raw text file
        fetch('https://raw.githubusercontent.com/NiwaFairy/MacroTranslator/main/Test.txt')
            .then(response => response.text())
            .then(text => {
                // Parse the text file content
                const lines = text.split('\n');
                lines.forEach(line => {
                    const [key, value, description] = line.split(' "');
                    if (key && value) {
                        const cleanedValue = value.replace(/"$/, ''); // Remove trailing quote
                        const desc = description ? description.replace(/"$/, '') : ''; // Remove trailing quote
                        translations[key] = {
                            translations: cleanedValue.split(', ').map(s => s.trim()),
                            description: desc
                        };
                    }
                });
                console.log('Translations:', translations); // Debug log
            })
            .catch(error => console.error('Error fetching translations:', error));

        document.getElementById('text-box').addEventListener('input', function() {
            const inputText = this.value;
            const outputDiv = document.getElementById('output');
            outputDiv.innerHTML = '';

            let processedText = inputText;
            Object.keys(translations).forEach(key => {
                const regex = new RegExp(`(${key})`, 'g');
                processedText = processedText.replace(regex, '<span class="highlight">$1</span>');
            });

            outputDiv.innerHTML = processedText;
        });

        document.getElementById('output').addEventListener('mousemove', function(e) {
            const tooltip = document.getElementById('tooltip');
            const target = e.target;

            if (target.classList.contains('highlight')) {
                const mouseX = e.clientX;
                const mouseY = e.clientY;
                tooltip.style.left = `${mouseX + 15}px`;
                tooltip.style.top = `${mouseY + 15}px`;

                const word = target.textContent.trim();
                const entry = translations[word];
                if (entry) {
                    const translationsText = entry.translations.join(', ');
                    tooltip.innerHTML = `
                        ${translationsText}
                        ${entry.description ? `<div class="tooltip-description">${entry.description}</div>` : ''}
                    `;
                    tooltip.style.display = 'block';
                } else {
                    tooltip.style.display = 'none';
                }
            } else {
                tooltip.style.display = 'none';
            }
        });

        document.getElementById('output').addEventListener('mouseleave', function() {
            const tooltip = document.getElementById('tooltip');
            tooltip.style.display = 'none';
        });
    </script>
</body>
</html>
